<section class="aphras-section">
  <div class="aphras-header">
    <img src="https://cdn.shopify.com/s/files/1/0314/6979/7515/files/Logo_V2_1.png?v=1753808379" alt="" style="width: 25%; height: auto;" height="auto">
  </div>

 
<div class="aphras-content">
 {% assign collection_ref = page.metafields.custom.assigned_collection.value %}

{% if collection_ref %}
  <div class="aphras-product-grid">
    {% for product in collection_ref.products %}
      <div class="aphras-product-card">
        <a href="{{ product.url }}">
          <img src="{{ product.featured_image | image_url: width: 600 }}" alt="{{ product.title }}">
        </a>
        <h3>{{ product.title }}</h3>
        <p class="price">{{ product.price | money }}</p>

        <form class="ajax-add-to-cart-form" data-product-id="{{ product.id }}">
  {% if product.variants.size > 1 %}
    <label for="variant-{{ product.id }}">Choose an option:</label>
    <select name="id" id="variant-{{ product.id }}">
      {% for variant in product.variants %}
        <option value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
      {% endfor %}
    </select>
  {% else %}
    <input type="hidden" name="id" value="{{ product.variants.first.id }}">
  {% endif %}
<div class="qty">
  <label for="quantity-{{ product.id }}">Quantity:</label>
  </div><div class="qty">
  <input type="number" name="quantity" id="quantity-{{ product.id }}" value="1" min="1">
  </div>

  <button type="submit">Add to Cart</button>
</form>

      </div>
    {% endfor %}
  </div>
{% endif %}


</div>

  <div class="aphras-footer">
    &copy; {{ 'now' | date: "%Y" }} Aphras. All rights reserved.
  </div>
</section>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    document.querySelectorAll('.ajax-add-to-cart-form').forEach(function (form) {
      form.addEventListener('submit', function (e) {
        e.preventDefault();

        const formData = new FormData(form);

        fetch('/cart/add.js', {
          method: 'POST',
          body: formData,
          headers: {
            'Accept': 'application/json'
          }
        })
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          //alert(`${data.title} added to cart!`);
          // Optionally update cart UI here
        })
        .catch(error => {
          console.error('Error adding to cart:', error);
          alert('Something went wrong. Please try again.');
        });
      });
    });
  });
</script>




<style>
  .aphras-section {
    font-family: 'Helvetica Neue', sans-serif;
    background-color: #fdf6f0;
    color: #3e3e3e;
    padding: 5px;
  }

  .aphras-header {
    background-color: #d8a47f;
    padding: 5px;
    text-align: center;
    color: white;
  }

  .aphras-content {
    max-width: 1920px;
    margin: 40px auto;
    padding: 5px;
    background: white;
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
  }

  .aphras-footer {
    background-color: #d8a47f;
    text-align: center;
    padding: 20px;
    font-size: 0.9em;
    color: #FEFEFE;
  }
  .aphras-product-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
    gap: 4px;
    margin-top: 4px;
  }

  .aphras-product-card {
    background-color: #ffffff;
    border: 1px solid #eee;
    border-radius: 8px;
    padding: 5px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
    text-align: center;
    font-family: 'Helvetica Neue', sans-serif;
  }
  .aphras-product-card .qty {
    text-align:center;
    margin:auto auto;
    
  }
  .aphras-product-card img {
    max-width: 100%;
    height: auto;
    border-radius: 4px;
    margin-bottom: 15px;
  }

  .aphras-product-card h3 {
    font-size: 1.3em;
    margin-bottom: 10px;
    color: #3e3e3e;
  }

  .aphras-product-card .price {
    font-weight: bold;
    color:rgb(255, 145, 56);
    margin-bottom: 15px;
    font-size: 1em;
  }

  .aphras-product-card select,
  .aphras-product-card input[type="number"] {
    width: 100%;
    padding: 8px;
    margin-bottom: 5px;
    border: 1px solid #ccc;
    border-radius: 4px;
  }

  .aphras-product-card button {
    background-color: #d8a47f;
    color: white;
    border: none;
    padding: 10px;
    width: 100%;
    border-radius: 4px;
    cursor: pointer;
    font-weight: bold;
  }

  .aphras-product-card button:hover {
    background-color: #c78a6b;
  }


</style>
